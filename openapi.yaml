openapi: 3.0.3
info:
  title: ExecFlex API
  description: |
    ExecFlex API - Combined API Server for executive matching and voice interactions.
    
    This API handles both web-based operations (role posting, matching, introductions) 
    and voice/telephony features powered by Ai-dan, an AI voice agent.
    
    ## Features
    - Executive candidate matching
    - Role posting and management
    - Email introductions
    - Voice calls via Twilio (Ai-dan)
    
    ## Authentication
    Most endpoints require JWT authentication via Supabase Auth. Include the JWT token in the Authorization header:
    `Authorization: Bearer <supabase_jwt_token>`
    
    Twilio webhook endpoints (`/voice/*`) are public and called by Twilio (signature verification recommended for production).
  version: 1.0.0
  contact:
    name: ExecFlex API Support
    url: https://execflex.com

servers:
  - url: https://execflex-backend-1.onrender.com
    description: Production server (Render)
  - url: http://localhost:5001
    description: Local development server

tags:
  - name: Health
    description: Health check endpoints
  - name: Matching
    description: Executive candidate matching
  - name: Roles
    description: Role posting and management
  - name: Introductions
    description: Email introductions between clients and candidates
  - name: Voice
    description: Voice/telephony features (Ai-dan) - Twilio webhooks
  - name: Onboarding
    description: Onboarding and qualification call management (admin-only)

paths:
  /:
    get:
      tags:
        - Health
      summary: Health check
      description: Simple health check endpoint that returns 200 if the service is running
      operationId: rootHealth
      responses:
        '200':
          description: Service is healthy

  /match:
    post:
      tags:
        - Matching
      summary: Find best candidate match
      description: |
        Finds the best matching executive candidate based on role requirements.
        Uses a scoring algorithm considering industry, expertise, availability, location, and salary.
        
        **Requires authentication** - JWT token in Authorization header.
      operationId: findMatch
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MatchRequest'
            example:
              industry: "Fintech"
              expertise: "CFO"
              availability: "fractional"
              min_experience: 10
              max_salary: 150000
              location: "Ireland"
      responses:
        '200':
          description: Match found or not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                  message:
                    type: string
                  match:
                    $ref: '#/components/schemas/Match'
                    nullable: true
                    description: Match details (best candidate) or null if no match
                  matches:
                    type: array
                    items:
                      $ref: '#/components/schemas/Match'
                    description: List of all matches (up to 5), sorted by score
              examples:
                match_found:
                  value:
                    ok: true
                    message: "We recommend John Smith: Experienced CFO with 15 years in Fintech"
                    match:
                      id: "cand-001"
                      name: "John Smith"
                      role: "CFO"
                      summary: "Experienced CFO with 15 years in Fintech"
                      location: "Ireland"
                      industries: ["Fintech", "SaaS"]
                      expertise: ["CFO", "Finance"]
                      availability: "fractional"
                      experience_years: 15
                      comp_expectation: 120000
                      highlights: ["Led Series B fundraising", "Built finance team from scratch"]
                      email: "john@example.com"
                no_match:
                  value:
                    ok: true
                    message: "No match found yet. We'll follow up with suggestions soon."
                    match: null
                    matches: []
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /post-role:
    post:
      tags:
        - Roles
      summary: Post a new executive role
      description: |
        Submit a new executive role posting to the platform.
        
        **Requires authentication** - JWT token in Authorization header. The authenticated user's ID will be used as the creator.
      operationId: postRole
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RolePostingRequest'
            example:
              role_title: "Chief Financial Officer"
              company_name: "Acme Corp"
              industry: "Fintech"
              role_description: "Leading financial strategy for Series B startup"
              experience_level: "Senior"
              commitment: "fractional"
              role_type: "CFO"
              is_remote: true
              location: "Ireland"
              budget_range: "€100k-€150k"
              contact_name: "Jane Doe"
              contact_email: "jane@acme.com"
              phone: "+353123456789"
      responses:
        '201':
          description: Role posted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                  message:
                    type: string
                  role:
                    $ref: '#/components/schemas/RolePosting'
                    nullable: true
                    description: The created role posting record
              example:
                ok: true
                message: "Role posted successfully!"
                role:
                  id: "role-123"
                  role_title: "Chief Financial Officer"
                  company_name: "Acme Corp"
                  industry: "Fintech"
                  created_at: "2024-01-15T10:30:00Z"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /request-intro:
    post:
      tags:
        - Introductions
      summary: Request an email introduction
      description: |
        Creates a thread and interaction for an introduction request, then sends an email introduction.
        The authenticated user's ID is used as the requester.
        
        **Requires authentication** - JWT token in Authorization header.
      operationId: requestIntro
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IntroRequest'
            example:
              user_type: "client"
              requester_name: "Jane Doe"
              requester_email: "jane@acme.com"
              requester_company: "Acme Corp"
              match_id: "cand-001"
              notes: "Series B GTM help needed"
      responses:
        '200':
          description: Introduction request processed
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                  thread_id:
                    type: string
                    description: ID of the created thread
                  interaction_id:
                    type: string
                    nullable: true
                    description: ID of the created interaction (if email sent)
                  email_sent:
                    type: boolean
                    description: Whether the introduction email was sent
                  status:
                    type: string
                    enum: [sent, pending]
                    description: Status of the introduction request
              example:
                ok: true
                thread_id: "thread-123"
                interaction_id: "interaction-456"
                email_sent: true
                status: "sent"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /voice/intro:
    post:
      tags:
        - Voice
      summary: Twilio webhook - Inbound call entry point
      description: |
        Entry point for inbound voice calls from users.
        Called by Twilio when a user calls the ExecFlex phone number.
        
        **Note:** This endpoint is for inbound calls only. For outbound qualification calls,
        see `/voice/qualify`.
        
        **Note:** This is a webhook endpoint, called by Twilio, not directly by API clients.
      operationId: voiceIntro
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                CallSid:
                  type: string
                  description: Twilio Call SID
      responses:
        '200':
          description: TwiML response for inbound call handling
          content:
            application/xml:
              schema:
                type: string
                description: TwiML XML with opening message and Gather
        '503':
          description: Voice features not available
    get:
      tags:
        - Voice
      summary: Twilio webhook - Inbound call entry point (GET)
      description: Alternative GET handler for inbound calls
      operationId: voiceIntroGet
      responses:
        '200':
          description: TwiML response
          content:
            application/xml:
              schema:
                type: string
        '503':
          description: Voice features not available

  /voice/qualify:
    post:
      tags:
        - Voice
      summary: Twilio webhook - Outbound qualification call handler
      description: |
        Outbound qualification call endpoint. Called by Twilio when an outbound qualification call is answered.
        
        This endpoint handles all logic for qualification calls:
        - OpenAI reasoning (with job seeker or talent seeker system prompts)
        - Storing interaction + turns in database
        - Converting text to speech with ElevenLabs
        - Incremental DB updates (people_profiles, organizations, role_assignments)
        
        **Flow:**
        1. Initial call: Twilio calls this endpoint when user answers → Returns opening message + Gather
        2. Subsequent turns: Twilio calls this endpoint after Gather → Processes user speech, calls OpenAI, returns next message
        
        **Note:** This is a webhook endpoint, called by Twilio, not directly by API clients.
        **Security:** Twilio signature verification required (X-Twilio-Signature header).
      operationId: voiceQualify
      parameters:
        - name: job_id
          in: query
          description: Job ID from outbound_call_jobs table (required)
          required: true
          schema:
            type: string
            format: uuid
          example: "123e4567-e89b-12d3-a456-426614174000"
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                CallSid:
                  type: string
                  description: Twilio Call SID
                  required: true
                SpeechResult:
                  type: string
                  description: Recognized speech text from user (present only for subsequent turns)
                Confidence:
                  type: string
                  description: Speech recognition confidence score (0.0-1.0)
      responses:
        '200':
          description: TwiML response for next turn or call termination
          content:
            application/xml:
              schema:
                type: string
                description: TwiML XML with next message, Gather (if continuing), or Hangup (if complete)
        '400':
          description: Missing job_id
        '403':
          description: Invalid Twilio signature
        '503':
          description: Voice features not available
    get:
      tags:
        - Voice
      summary: Twilio webhook - Outbound qualification call handler (GET)
      description: Alternative GET handler
      operationId: voiceQualifyGet
      parameters:
        - name: job_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: TwiML response
          content:
            application/xml:
              schema:
                type: string
        '503':
          description: Voice features not available

  /voice/turn:
    post:
      tags:
        - Voice
      summary: Twilio webhook - Inbound call turn handler
      description: |
        Turn handler for inbound voice conversations.
        Called by Twilio after Gather collects user speech during inbound calls.
        
        **Note:** This endpoint is for inbound calls only. For outbound qualification calls,
        see `/voice/qualify`.
      operationId: voiceTurn
      parameters:
        - name: step
          in: query
          description: Current conversation step
          schema:
            type: string
            enum: [user_type, name, role, industry, location, availability, confirm_intro, email]
          example: "name"
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                CallSid:
                  type: string
                  description: Twilio Call SID
                SpeechResult:
                  type: string
                  description: Recognized speech text from user
                Confidence:
                  type: string
                  description: Speech recognition confidence score (0.0-1.0)
      responses:
        '200':
          description: TwiML response for next step or call termination
          content:
            application/xml:
              schema:
                type: string
                description: TwiML XML
        '503':
          description: Voice features not available
    get:
      tags:
        - Voice
      summary: Twilio webhook - Inbound call turn handler (GET)
      description: Alternative GET handler for inbound calls
      operationId: voiceTurnGet
      parameters:
        - name: step
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: TwiML response
          content:
            application/xml:
              schema:
                type: string
        '503':
          description: Voice features not available

  /voice/status:
    post:
      tags:
        - Voice
      summary: Unified Twilio webhook - Call status callback
      description: |
        Unified status callback webhook for all Twilio voice calls.
        Receives call status updates (initiated, ringing, answered, completed, failed, etc.)
        and updates job and interaction records accordingly.
        
        **Note:** This is a webhook endpoint, called by Twilio, not directly by API clients.
        **Security:** Twilio signature verification required (X-Twilio-Signature header).
      operationId: voiceStatus
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                CallSid:
                  type: string
                  description: Twilio Call SID
                  required: true
                CallStatus:
                  type: string
                  description: Call status
                  enum: [queued, ringing, in-progress, completed, failed, busy, no-answer, canceled]
                CallDuration:
                  type: string
                  description: Call duration in seconds (only for completed calls)
                From:
                  type: string
                  description: Caller's phone number
                To:
                  type: string
                  description: Called phone number
      responses:
        '200':
          description: Status update processed
          content:
            text/plain:
              schema:
                type: string
                example: "OK"
        '400':
          description: Missing CallSid
        '403':
          description: Invalid Twilio signature

  /voice/capture:
    post:
      tags:
        - Voice
      summary: Legacy Twilio webhook - Speech capture (deprecated)
      description: |
        **DEPRECATED:** Legacy endpoint for inbound call conversation flow.
        Kept for backward compatibility only.
        
        Use `/voice/inbound` instead for inbound call handling.
        
        **Note:** This is a webhook endpoint, typically called by Twilio, not directly by API clients.
      operationId: voiceCapture
      deprecated: true
      parameters:
        - name: step
          in: query
          description: Current conversation step
          schema:
            type: string
            enum: [user_type, name, role, industry, location, availability, confirm_intro, email]
          example: "name"
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                CallSid:
                  type: string
                  description: Twilio Call SID
                SpeechResult:
                  type: string
                  description: Recognized speech text
                Confidence:
                  type: string
                  description: Speech recognition confidence score
      responses:
        '200':
          description: TwiML response for next step or call termination
          content:
            application/xml:
              schema:
                type: string
                description: TwiML XML
        '503':
          description: Voice features not available
    get:
      tags:
        - Voice
      summary: Legacy Twilio webhook - Speech capture (GET, deprecated)
      description: Alternative GET handler (deprecated - use /voice/inbound)
      operationId: voiceCaptureGet
      deprecated: true
      parameters:
        - name: step
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: TwiML response
          content:
            application/xml:
              schema:
                type: string
        '503':
          description: Voice features not available

  /onboarding/enqueue:
    post:
      tags:
        - Onboarding
      summary: Manually trigger onboarding for a user (admin-only)
      description: |
        Manually trigger onboarding for a user. This endpoint requires authentication AND admin role.
        Used for manual/admin triggers, testing, or re-triggering onboarding.
        
        **Note:** Automatic onboarding is handled by database trigger on signup,
        so this endpoint is primarily for admin operations or edge cases.
        
        **Requires:** JWT authentication + admin role in role_assignments table.
      operationId: enqueueOnboarding
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id
              properties:
                user_id:
                  type: string
                  format: uuid
                  description: The user_id to initialize onboarding for
                  example: "123e4567-e89b-12d3-a456-426614174000"
      responses:
        '200':
          description: Onboarding triggered
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                  job_id:
                    type: string
                    format: uuid
                    description: ID of the created outbound call job
                  thread_id:
                    type: string
                    format: uuid
                    description: ID of the created thread
                  interaction_id:
                    type: string
                    format: uuid
                    nullable: true
                    description: ID of the created interaction
                  status:
                    type: string
                    enum: [queued, running, succeeded, failed]
                    description: Status of the onboarding job
              example:
                ok: true
                job_id: "123e4567-e89b-12d3-a456-426614174000"
                thread_id: "456e7890-e89b-12d3-a456-426614174001"
                interaction_id: "789e0123-e89b-12d3-a456-426614174002"
                status: "queued"
        '400':
          description: Missing user_id
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin role required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /onboarding/set-admin:
    post:
      tags:
        - Onboarding
      summary: Grant admin role to a user (admin-only)
      description: |
        Grant admin role to a user. This endpoint requires authentication AND admin role.
        Adds 'admin' role to the specified user in role_assignments table.
        
        **Note:** If the user already has admin role, returns success without creating duplicate.
        
        **Requires:** JWT authentication + admin role in role_assignments table.
      operationId: setAdmin
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user_id
              properties:
                user_id:
                  type: string
                  format: uuid
                  description: UUID of the user to grant admin role to
                  example: "123e4567-e89b-12d3-a456-426614174000"
      responses:
        '200':
          description: Admin role granted (or already exists)
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                  message:
                    type: string
                    description: Status message
                  user_id:
                    type: string
                    format: uuid
                    description: ID of the user
                  already_admin:
                    type: boolean
                    description: Whether user already had admin role
                  role_assignment_id:
                    type: string
                    format: uuid
                    nullable: true
                    description: ID of the role assignment (if newly created)
              example:
                ok: true
                message: "Admin role granted successfully"
                user_id: "123e4567-e89b-12d3-a456-426614174000"
                already_admin: false
                role_assignment_id: "456e7890-e89b-12d3-a456-426614174001"
        '400':
          description: Missing user_id
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin role required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error granting admin role
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /onboarding/delete-user:
    post:
      tags:
        - Onboarding
      summary: Delete a user and all associated data (admin-only)
      description: |
        Delete a user and all associated data. This endpoint requires authentication AND admin role.
        Performs comprehensive cleanup of all user-related data including:
        - outbound_call_jobs, thread_participants, threads, organization_members
        - opportunities, match_suggestions, channel_identities
        - role_assignments, user_preferences, people_profiles
        - organizations (sets created_by_user_id to NULL)
        - auth.users (via Supabase Admin API)
        
        **Note:** Interactions are append-only (event sourcing) and remain as historical records.
        This is by design - interactions serve as an immutable audit trail.
        
        **Requires:** JWT authentication + admin role in role_assignments table.
      operationId: deleteUser
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: []
              properties:
                user_id:
                  type: string
                  format: uuid
                  description: UUID of the user to delete
                  example: "123e4567-e89b-12d3-a456-426614174000"
                phone:
                  type: string
                  description: Phone number (E.164 format) to find and delete user by
                  example: "+447463212071"
              oneOf:
                - required: [user_id]
                - required: [phone]
      responses:
        '200':
          description: User deletion completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                  user_id:
                    type: string
                    format: uuid
                    description: ID of the deleted user
                  deleted_tables:
                    type: array
                    items:
                      type: string
                    description: List of tables that were successfully deleted from
                  errors:
                    type: array
                    items:
                      type: string
                    description: List of errors encountered during deletion
                  warnings:
                    type: array
                    items:
                      type: string
                    description: List of warnings (e.g., append-only interactions)
                  auth_user_deleted:
                    type: boolean
                    description: Whether the auth user was successfully deleted
                  success:
                    type: boolean
                    description: Whether deletion completed without errors
                  message:
                    type: string
                    description: Status message
              example:
                ok: true
                user_id: "123e4567-e89b-12d3-a456-426614174000"
                deleted_tables:
                  - "outbound_call_jobs"
                  - "role_assignments"
                  - "user_preferences"
                  - "people_profiles"
                  - "threads (marked inactive)"
                  - "organizations (updated)"
                errors: []
                warnings:
                  - "Interactions are append-only and remain as historical records"
                auth_user_deleted: true
                success: true
                message: "User 123e4567-e89b-12d3-a456-426614174000 deletion completed"
        '400':
          description: Missing user_id or phone, or could not determine user_id
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin role required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: User not found (when searching by phone)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error deleting user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /onboarding/process-jobs:
    post:
      tags:
        - Onboarding
      summary: Manually trigger job processing (optional)
      description: |
        Endpoint to trigger job processing for HTTP-based cron/scheduled tasks.
        
        **Note:** This endpoint is optional. If using Render Background Workers,
        you can run `python -m workers.call_dispatcher` directly instead.
        
        Processes queued outbound call jobs and initiates Twilio calls.
      operationId: processJobs
      parameters:
        - name: limit
          in: query
          description: Maximum number of jobs to process
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: Jobs processed
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                  processed:
                    type: integer
                    description: Number of jobs processed
                  message:
                    type: string
              example:
                ok: true
                processed: 3
                message: "Processed 3 jobs"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /onboarding/status:
    post:
      tags:
        - Onboarding
      summary: DEPRECATED - Twilio status callback (use /voice/status)
      description: |
        **DEPRECATED:** This endpoint is kept for backward compatibility only.
        Use `/voice/status` instead.
        
        Twilio status callback webhook for onboarding calls.
        Updates job and interaction records with call status.
      operationId: onboardingStatus
      deprecated: true
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                CallSid:
                  type: string
                  description: Twilio Call SID
                  required: true
                CallStatus:
                  type: string
                  description: Call status
                  enum: [queued, ringing, in-progress, completed, failed, busy, no-answer, canceled]
                CallDuration:
                  type: string
                  description: Call duration in seconds
                From:
                  type: string
                  description: Caller's phone number
                To:
                  type: string
                  description: Called phone number
      responses:
        '200':
          description: Status update processed
          content:
            text/plain:
              schema:
                type: string
                example: "OK"
        '400':
          description: Missing CallSid

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Supabase JWT token from authenticated user session.
        Get the token from `supabase.auth.getSession()` in the frontend.
        Include in header: `Authorization: Bearer <token>`

  schemas:
    Match:
      type: object
      description: Executive candidate match result
      properties:
        id:
          type: string
          description: Candidate ID
          example: "cand-001"
        name:
          type: string
          description: Full name of candidate
          example: "John Smith"
        role:
          type: string
          description: Role/title
          example: "CFO"
        summary:
          type: string
          description: Brief summary/bio
          example: "Experienced CFO with 15 years in Fintech"
        location:
          type: string
          description: Location preference
          example: "Ireland"
        industries:
          type: array
          items:
            type: string
          description: List of industries
          example: ["Fintech", "SaaS"]
        expertise:
          type: array
          items:
            type: string
          description: List of expertise areas
          example: ["CFO", "Finance"]
        availability:
          type: string
          description: Availability type
          enum: [fractional, full_time]
          example: "fractional"
        experience_years:
          type: integer
          description: Years of experience
          example: 15
        comp_expectation:
          type: integer
          description: Compensation expectation
          example: 120000
        highlights:
          type: array
          items:
            type: string
          description: Key achievements/highlights
          example: ["Led Series B fundraising", "Built finance team from scratch"]
        email:
          type: string
          format: email
          description: Contact email
          example: "john@example.com"

    ErrorResponse:
      type: object
      required:
        - ok
        - error
      properties:
        ok:
          type: boolean
          example: false
        error:
          type: string
          description: Error message
          example: "Missing required fields: email, name"

    MatchRequest:
      type: object
      description: |
        All fields are optional. The matching algorithm will score candidates based on provided criteria.
        If no criteria are provided, returns all available candidates.
      properties:
        industry:
          type: string
          description: Industry focus (e.g., Fintech, SaaS, Insurance)
          example: "Fintech"
        expertise:
          type: string
          description: Desired role/expertise (e.g., CFO, CEO, CTO)
          example: "CFO"
        availability:
          type: string
          description: Availability type (fractional or full_time)
          enum: [fractional, full_time]
          example: "fractional"
        min_experience:
          type: integer
          description: Minimum years of experience required
          minimum: 0
          example: 10
        max_salary:
          type: integer
          description: Maximum salary budget
          minimum: 0
          example: 150000
        location:
          type: string
          description: Location preference (e.g., Ireland, UK, Remote)
          example: "Ireland"

    RolePostingRequest:
      type: object
      required:
        - role_title
        - industry
        - role_description
        - experience_level
        - commitment
        - role_type
      properties:
        role_title:
          type: string
          example: "Chief Financial Officer"
        company_name:
          type: string
          nullable: true
          example: "Acme Corp"
        industry:
          type: string
          example: "Fintech"
        role_description:
          type: string
          example: "Leading financial strategy for Series B startup"
        experience_level:
          type: string
          example: "Senior"
        commitment:
          type: string
          description: Commitment type (fractional or full_time)
          enum: [fractional, full_time]
          example: "fractional"
        role_type:
          type: string
          description: Role type (CFO, CEO, CTO, etc.)
          example: "CFO"
        is_remote:
          type: boolean
          default: false
          example: true
        location:
          type: string
          nullable: true
          example: "Ireland"
        budget_range:
          type: string
          nullable: true
          example: "€100k-€150k"
        contact_name:
          type: string
          nullable: true
          example: "Jane Doe"
        contact_email:
          type: string
          nullable: true
          example: "jane@acme.com"
        phone:
          type: string
          nullable: true
          example: "+353123456789"
        linkedin:
          type: string
          nullable: true
          example: "https://linkedin.com/company/acme"
        website:
          type: string
          nullable: true
          example: "https://acme.com"
        company_mission:
          type: string
          nullable: true
          example: "Building the future of fintech"

    RolePosting:
      type: object
      properties:
        id:
          type: string
        role_title:
          type: string
        company_name:
          type: string
          nullable: true
        industry:
          type: string
        role_description:
          type: string
        experience_level:
          type: string
        commitment_type:
          type: string
        role_type:
          type: string
        is_remote:
          type: boolean
        location:
          type: string
          nullable: true
        compensation:
          type: string
          nullable: true
        contact_name:
          type: string
          nullable: true
        contact_email:
          type: string
          nullable: true
        phone:
          type: string
          nullable: true
        linkedin:
          type: string
          nullable: true
        website:
          type: string
          nullable: true
        company_mission:
          type: string
          nullable: true
        created_at:
          type: string
          format: date-time

    IntroRequest:
      type: object
      required:
        - user_type
        - requester_name
        - requester_email
        - match_id
      properties:
        user_type:
          type: string
          enum: [client, candidate]
          description: Type of user making the request
          example: "client"
        requester_name:
          type: string
          example: "Jane Doe"
        requester_email:
          type: string
          format: email
          example: "jane@acme.com"
        requester_company:
          type: string
          nullable: true
          example: "Acme Corp"
        match_id:
          type: string
          description: ID of the candidate/match (people_profiles.id or user_id)
          example: "cand-001"
        notes:
          type: string
          nullable: true
          description: Additional notes about the introduction
          example: "Series B GTM help needed"
        opportunity_id:
          type: string
          nullable: true
          description: Optional opportunity ID to link this introduction to
          example: "opp-123"

